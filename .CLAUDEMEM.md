# Dr. Kirodi Lal Meena - Official Website & Admin Panel

**Project Type:** Political representative website with CMS and citizen grievance management system
**Languages:** Hindi (default), English (bilingual)
**Tech Stack:** Next.js 16, React 19, TypeScript, Prisma, PostgreSQL, Tailwind CSS 4, shadcn/ui

---

## Project Overview

This is the official website for Dr. Kirodi Lal Meena, featuring:
- **Public facing site:** Biography, timeline, galleries, press releases, blogs
- **Citizen application system:** Public can submit grievances/applications
- **Admin dashboard:** Staff can manage applications, content, and view analytics
- **CMS:** Dynamic page builder with sections, menu management, site settings

---

## Tech Stack Details

| Category | Technology | Version |
|-----------|-------------|----------|
| Framework | Next.js (App Router) | 16.1.6 |
| UI Library | React | 19.2.3 |
| Language | TypeScript | 5 |
| Styling | Tailwind CSS | 4 |
| Components | shadcn/ui | Latest |
| Database | PostgreSQL | - |
| ORM | Prisma | 7.4.0 |
| Auth | NextAuth.js | 5.0.0-beta.30 |
| i18n | next-intl | 4.8.2 |
| Animations | Framer Motion | 12.33.0 |
| Charts | Recharts | 3.7.0 |
| Forms | react-hook-form + zod | 7.71.1 + 4.3.6 |
| Icons | Lucide React | 0.563.0 |
| Media Storage | Cloudinary | 2.9.0 |

---

## Project Structure

```
drkiodilal.in/
├── src/
│   ├── app/                          # Next.js App Router
│   │   ├── [locale]/               # i18n routes (hi, en)
│   │   │   ├── (public)/          # Public pages (route group)
│   │   │   │   ├── page.tsx        # Home page
│   │   │   │   ├── biography/       # (deleted, moved to CMS)
│   │   │   │   └── journey/         # (deleted, moved to CMS)
│   │   ├── admin/                  # Admin panel routes
│   │   │   ├── (dashboard)/       # Protected admin pages
│   │   │   │   ├── dashboard/     # Statistics, overview
│   │   │   │   ├── applications/   # Application management
│   │   │   │   ├── blogs/          # Blog CRUD
│   │   │   │   ├── press-releases/ # Press release CRUD
│   │   │   │   ├── reports/        # Data exports
│   │   │   │   ├── settings/       # Admin settings
│   │   │   │   ├── pages/          # CMS page builder
│   │   │   │   └── menus/          # Navigation management
│   │   ├── [...slug]/              # Dynamic CMS page renderer
│   │   ├── actions/               # Server Actions
│   │   ├── api/                   # API Routes
│   │   │   ├── admin/             # Admin CRUD endpoints
│   │   │   ├── sign-cloudinary.ts  # Cloudinary signature
│   │   │   ├── upload/            # File upload handler
│   │   │   └── export/           # Excel export
│   │   ├── layout.tsx              # Root layout with fonts
│   │   └── globals.css            # Tailwind config + styles
│   ├── components/
│   │   ├── ui/                    # shadcn/ui components
│   │   ├── admin/                  # Admin-specific components
│   │   ├── cms/                   # CMS block renderers
│   │   ├── common/                 # Shared components
│   │   ├── forms/                  # Form components
│   │   ├── layout/                 # Header, Footer
│   │   └── sections/               # Page sections
│   ├── data/                       # Static data (timeline, etc)
│   ├── hooks/                      # Custom React hooks
│   ├── i18n/                      # Internationalization config
│   ├── lib/                        # Utilities (db, auth, utils)
│   └── types/                      # TypeScript types
├── messages/                        # i18n translations (hi.json, en.json)
├── prisma/
│   ├── schema.prisma                # Database schema
│   ├── seed.ts                     # Database seeding
│   └── migrations/                 # Prisma migrations
├── public/                         # Static assets
├── scripts/                        # Utility scripts
│   ├── create-admin.ts              # Create admin user
│   ├── update-admin-password.ts      # Update admin password
│   ├── seed-timeline.ts            # Seed timeline data
│   ├── get-users.ts                # List users
│   └── verify-login.ts             # Test login
└── CLAUDE.md                       # This file
```

---

## Database Schema Summary

### Master Data
- `Vidhansabha` - Legislative constituencies (name_hi, name_en)
- `WorkType` - Categories of citizen work requests (name_hi, name_en)

### Authentication
- `User` - Admin users (email, password, name, role: SUPER_ADMIN|ADMIN|STAFF)

### Application Management
- `CitizenApp` - Citizen applications/grievances
  - Links to: Vidhansabha, WorkType, User (submitted_by)
  - Fields: name, fatherName, address, mobile, type (CITIZEN|PUBLIC_REP), status
- `Document` - Attached files (PDF or IMAGE)
- `ActivityLog` - Status change history

### Content Management
- `BlogPost` - Blog articles
- `PressRelease` - Official announcements with PDF
- `TimelineEvent` - Life/career milestones
- `Page` - Dynamic CMS pages
- `PageSection` - Page content blocks (HERO, RICHTEXT, TIMELINE, GALLERY, VIDEOS, etc.)

### CMS Resources
- `SiteSetting` - Global configuration (hero_title, contact_email, etc.)
- `Menu` - Navigation (hierarchical, HEADER|FOOTER|SIDEBAR)
- `GalleryAlbum`, `GalleryPhoto` - Photo galleries
- `Video` - YouTube video links
- `Testimonial` - User testimonials
- `ContactQuery` - Contact form submissions

---

## Typography System (Recently Implemented)

### Font Variables
```css
--font-sans: var(--font-geist-sans);      # Primary UI font
--font-mono: var(--font-geist-mono);      # IDs, phone numbers, data
--font-heading: var(--font-geist-sans);    # Headings
--font-hindi: var(--font-hindi);           # Noto Sans Devanagari
```

### Dashboard Typography Classes
```css
.dashboard-title    /* Page titles - 24-30px bold */
.dashboard-section  /* Section headers - 18px semibold */
.dashboard-card-title /* Card headers - 16px semibold */
.dashboard-label     /* Form labels - 14px medium */
.dashboard-body      /* Body text - 14px leading-relaxed */
.dashboard-data      /* Table data - 14px mono */
.dashboard-stat      /* KPI values - 20-30px bold, tabular */
.dashboard-badge     /* Badge text - 12px semibold */
.dashboard-mono     /* IDs, phone - 14px mono tracking-wide */
```

### Hindi Typography
- Uses Noto Sans Devanagari with weights: 400, 500, 600, 700
- Line-height: 1.7 for body, 1.4 for headings
- Font-size: 1.05em for paragraphs
- Applied via `.lang-hi` class on body element

---

## i18n Configuration

**Locales:** Hindi (`hi` - default), English (`en`)

**Strategy:** Always prefix - routes are `/hi/...` or `/en/...`

**Config:** `src/i18n/routing.ts`
```tsx
export const routing = defineRouting({
  locales: ['hi', 'en'],
  defaultLocale: 'hi',
  localePrefix: 'always'
});
```

**Translation Files:** `messages/hi.json`, `messages/en.json`

**Usage:**
- Server: `setRequestLocale(locale)`, `getMessages()`
- Client: `useTranslations()`, `useLocale()`
- Navigation: `import { Link } from '@/i18n/navigation'`

---

## Authentication Flow

**Provider:** NextAuth.js v5 with Credentials provider

**Configuration:** `src/lib/auth.ts`
- Session strategy: JWT
- Credentials: Email + Password (bcrypt hashed)
- Callbacks: User data attached to session

**Protected Routes:** Middleware (`src/middleware.ts`) checks:
```tsx
const session = await getToken();
if (!session && pathname.startsWith('/admin')) {
  return NextResponse.redirect(new URL('/login', request.url));
}
```

**User Roles:**
- `SUPER_ADMIN` - Full access
- `ADMIN` - Admin operations
- `STAFF` - View and update applications only

---

## Development Commands

```bash
# Development
npm run dev                # Start dev server

# Database
npx prisma generate       # Generate Prisma client
npx prisma db push      # Push schema to database
npx prisma db seed      # Seed database
npx prisma studio       # Open Prisma Studio

# Admin Scripts
npx tsx scripts/create-admin.ts           # Create admin user
npx tsx scripts/update-admin-password.ts   # Update password
npx tsx scripts/verify-login.ts          # Test login
npx tsx scripts/get-users.ts             # List users

# Build & Deploy
npm run build            # Production build
npm run start            # Start production server
npm run lint            # Run ESLint
```

---

## Key Patterns & Conventions

### File Naming
- **Pages:** `page.tsx` (always lowercase)
- **Components:** `PascalCase.tsx` (e.g., `AdminSidebar.tsx`)
- **Server Actions:** kebab-case files in `src/app/actions/`
- **API Routes:** `route.ts` files

### Component Structure
```tsx
'use client';              // For interactive components
import { setRequestLocale } from 'next-intl/server';

type Props = {
    params: Promise<{ locale: string }>;
};

export default async function Component({ params }: Props) {
    const { locale } = await params;
    setRequestLocale(locale);

    return <div>...</div>;
}
```

### Server Actions Pattern
```tsx
'use server';
import prisma from '@/lib/db';

export async function actionName(data: FormData) {
    // Validation
    // Database operation
    // Revalidate path
}
```

### Styling Conventions
- Use shadcn/ui components from `@/components/ui/`
- Tailwind classes with responsive variants: `text-sm sm:text-base`
- Dark mode: Use semantic colors (`bg-background`, `text-foreground`)
- Custom components: Add to `@layer components` in `globals.css`

---

## Recent Changes

### Font Management System (2026-02-12)
- Added font variables to Tailwind v4 `@theme inline` block
- Created dashboard typography utility classes (`.dashboard-title`, `.dashboard-section`, etc.)
- Added responsive typography utilities (`.text-responsive-*`)
- Created `src/hooks/useTypography.ts` for dynamic font selection
- Updated admin components to use new typography classes
- Added explicit font weights to Geist imports
- Applied tabular numbers to KPI values and data tables

### Deleted Pages (Migration to CMS)
- `src/app/[locale]/(public)/biography/page.tsx` → Use CMS Pages instead
- `src/app/[locale]/(public)/journey/page.tsx` → Use CMS Pages instead
- Backup files: `.bak` versions exist

---

## Environment Variables

Required `.env` variables:
```bash
DATABASE_URL=            # PostgreSQL connection
NEXTAUTH_SECRET=         # Auth secret
NEXTAUTH_URL=           # Auth URL
CLOUDINARY_CLOUD_NAME=  # Cloudinary cloud name
CLOUDINARY_API_KEY=     # Cloudinary API key
CLOUDINARY_API_SECRET=   # Cloudinary API secret
CLOUDINARY_UPLOAD_PRESET= # Upload preset name
```

---

## Common Issues & Solutions

### Build Errors
- **Font variable not found:** Ensure font imports in `layout.tsx` match CSS variables
- **Prisma client not generated:** Run `npx prisma generate`
- **i18n route mismatch:** Check `src/i18n/routing.ts` locale config

### Database Issues
- **Connection errors:** Verify `DATABASE_URL` in `.env`
- **Schema sync:** Run `npx prisma db push` after schema changes
- **Seed data:** Run `npx prisma db seed` to populate master data

### Styling Issues
- **Dark mode colors:** Always use semantic CSS variables (`--foreground`, `--background`)
- **Responsive text:** Use `text-sm sm:text-base lg:text-lg` pattern
- **iOS input zoom:** Input font-size must be ≥16px (use `.dashboard-label` class)

---

## Future Tasks & Improvements

### Priority 1 (High)
- Migrate biography and journey to CMS pages
- Add server-side form validation with Zod schemas
- Implement error boundary for better error handling
- Add loading skeletons for data fetching

### Priority 2 (Medium)
- Add pagination to applications list
- Implement advanced filtering (date range, multiple statuses)
- Add bulk actions (approve multiple, export selected)
- Improve accessibility (ARIA labels, keyboard navigation)

### Priority 3 (Low)
- Add unit tests for critical functions
- Implement E2E tests with Playwright
- Optimize images (WebP, lazy loading)
- Add PWA support

---

## Contact & Resources

- **Project Root:** `/Users/chandangaur/Sites/kirodi-site/drkiodilal.in`
- **Git Branch:** `main`
- **Admin Login:** `/hi/admin/login` or `/en/admin/login`
- **Documentation:** This file (`CLAUDE.md`)

---

*Last Updated: February 12, 2026*
